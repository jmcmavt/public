from scapy.all import *
import time

ruby = "128.173.54.143"
violet = "128.173.54.101"
dest_ip = "10.0.0.2"

"""
1. Build a packet that:
- Is an IPv4 TCP packet
- Spoofs ruby.cirt.vt.edu as the source address
- Sets the SYN flag
- is sent to port 20
- Send 20 of these packets
"""

def task1():
	task1_packet = IP(src=ruby, dst=dest_ip)/TCP(dport=20, flags=2)
	send(task1_packet, count=20)

"""
2. Build a packet that:
	- Is an IPv4 packet
	- Is an ICMP type 4 packet
	- Set the ICMP checksum to 100
	- Spoofs violet.cirt.vt.edu as the source
	- Send 35 of these packets
"""

def task2():
	task2_packet = IP(src=violet, dst=dest_ip)/ICMP(type=4, chksum=100)
	send(task2_packet, count=35)

"""
3. Build a packet that:
	- Is an IPv4 packet
	- Has SYN, FIN, RST flags set
	- spoofs violet.cirt.vt.edu as the source
	- start at source port 32700 and increments by 1 for each sent
	- has your team number as the payload in the form "teamXX"
	  where "XX" is your two digit team number (zero pad if needed).
	- Send 10 of these packets
"""
def task3():
	source_port = 32700
	while source_port < 32710:
		task3_packet = IP(src=violet, dst=dest_ip)/TCP(sport=source_port,flags=7)/"team02"
		send(task3_packet)
		source_port = source_port + 1
	
task1()
time.sleep(5) 
task2()
time.sleep(5)
task3()
